---
title: "Parametric distributions"
description: "[Exercise 1]{.tag-workshop}"
image: /images/ex1-cover.jpeg
format:
  live-html:
    toc: true
    toc-location: left
knitr: true
webr:
  packages:
    - dplyr
    - ggplot2
    - agridat
live:
  show-hints: true
  show-solutions: true
execute:
  cache: false
---


{{< include _head.qmd >}}



```{webr}
#| include: false
#| autorun: true
options(width = 75)
```

## Exercise 1.1

Try simulating a sequence of 100 Bernoulli trials with a success probability of 0.3.

```{webr}
#| exercise: ex_1
#| caption: Exercise 1
______(______)
```


::: {.solution exercise="ex_1"}

#### Solution


```{webr}
#| exercise: ex_1
#| solution: true
rbinom(100, 1, 0.3)
```

:::

::: { .hint exercise="ex_1"}
::: { .callout-note collapse="false"}
## Hint 1

Bernoulli trials are a special case of binomial trials.

```r
rbinom(______)
```
:::
:::

::: { .hint exercise="ex_1"}
::: { .callout-note collapse="false"}
## Hint 2

A Bernoulli trial has only one trial and the probability of success is 0.3.

How many trials do you want to simulate?

```r
rbinom(______, 1, 0.3)
```
:::
:::

```{webr}
#| exercise: ex_1
#| check: true
gradethis::grade_this_code()
```

## Exercise 1.2

Now try generating a sequence of 20 random numbers, each representing the number of successes in 100 independent Bernoulli trials with a success probability of 0.3.


```{webr}
#| exercise: ex_2
#| caption: Exercise 2
______(______)
```


::: {.solution exercise="ex_2"}

#### Solution


```{webr}
#| exercise: ex_2
#| solution: true
rbinom(20, 100, 0.3)
```

:::

::: { .hint exercise="ex_2"}
::: { .callout-note collapse="false"}
## Hint 1

The number of successes from independent Bernoulli trials follows a binomial distribution.


```r
rbinom(______)
```
:::
:::

::: { .hint exercise="ex_2"}
::: { .callout-note collapse="false"}
## Hint 2

The number of Bernoulli trials is 100 for each simulation. 

How many numbers did you want to simulate?

```r
rbinom(______, 100, 0.3)
```
:::
:::

```{webr}
#| exercise: ex_2
#| check: true
gradethis::grade_this_code()
```

## Exercise 1.3

Kylie Kelce is expecting a fourth baby girl. All four of her children are girls. What is the probability this occurs? 


```{webr}
#| exercise: ex_3
#| caption: Exercise 3
dbinom(______)
```


::: {.solution exercise="ex_3"}

#### Solution


```{webr}
#| exercise: ex_3
#| solution: true
dbinom(4, 4, 0.5)
```

:::

::: { .hint exercise="ex_3"}
::: { .callout-note collapse="false"}
## Hint 1

The sex of each child is independent of the others and the chance of either male or female sex is approximately 0.5.



```r
dbinom(______, 4, 0.5)
```
:::
:::


```{webr}
#| exercise: ex_3
#| check: true
gradethis::grade_this_code()
```

## Exercise 1.4

I have 40 plants each with a 0.8 probability of surviving in a given environment. What is the probability that equal to or more than 30 plants would survive in this environment?



```{webr}
#| exercise: ex_4
#| caption: Exercise 4
1 - pbinom(______)
```


::: {.solution exercise="ex_4"}

#### Solution


```{webr}
#| exercise: ex_4
#| solution: true
1 - pbinom(29, 40, 0.8)
```

:::

::: { .hint exercise="ex_4"}
::: { .callout-note collapse="false"}
## Hint 1


Remember that the converse of greater than or equal to 30 is less than or equal to 29 if we are only considering integers. 



```r
1 - pbinom(______, 40, 0.8)
```
:::
:::


```{webr}
#| exercise: ex_4
#| check: true
gradethis::grade_this_code()
```


## Exercise 1.5

An adult height is typically about 1.75m with standard deviation of 7cm for males in Australia. Gough Whitlam was 1.94m in height. What is the probability that a random Australian male is taller than Gough Whitlam?



```{webr}
#| exercise: ex_5
#| caption: Exercise 5
1 - pnorm(194, ______, ______)
```


::: {.solution exercise="ex_5"}

#### Solution


```{webr}
#| exercise: ex_5
#| solution: true
1 - pnorm(194, 175, 7)
```

:::

::: { .hint exercise="ex_5"}
::: { .callout-note collapse="false"}
## Hint 1


Remember that the mean and standard deviation should have the same unit of measurement. 


```r
1 - pnorm(194, ______, 7)
```
:::
:::


```{webr}
#| exercise: ex_5
#| check: true
gradethis::grade_this_code()
```


## Exercise 1.6

In a population of a particular species of fish, the length of the fish is normally distributed with a mean of 175mm and a standard deviation of 7mm. Simulate a scenario were twenty fish were caught and measured. What proportion of fishes were longer than 194mm? 

How does the proportion compare to the answer in Exercise 5?


```{webr}
#| exercise: ex_6
#| caption: Exercise 6
fish_lengths <- rnorm(______)
mean(fish_lengths > 194)
```


::: {.solution exercise="ex_6"}

#### Solution

Notice that the this scenario is similar to Exercise 5, except the proportion is calculated from a finite sample, whereas the previous exercise was calculated considering the distribution in the population. 


```{webr}
#| exercise: ex_6
#| solution: true
fish_lengths <- rnorm(20, 175, 7)
mean(fish_lengths > 194)
```

:::


```{webr}
#| exercise: ex_6
#| check: true
gradethis::grade_this_code()
```


## Exercise 1.7

For this exericse, the `dplyr` and `ggplot2` packages have been loaded. 

```{webr}
#| edit: false
#| autorun: true
library(dplyr)
library(ggplot2)
```

The `sugarcane` data cotains 2,056 observations of sugarcane yield from a uniformity trial. This `sugarcane` data is also already loaded in the exercise environment with a glimpse of the data below. 

```{webr}
#| include: false
sugarcane <- agridat::sayer.sugarcane.uniformity |> subset(select = yield)
```


```{webr}
#| edit: false
#| autorun: true
glimpse(sugarcane)
```

Create a histogram of the `yield` variable with 30 bins but show the $y$-axis as a density instead of counts. 


```{webr}
#| exercise: ex_71
#| caption: Exercise 7.1
ggplot(sugarcane, aes(x = ______)) +
  geom_histogram(aes(y = after_stat(density)), bins = ______, color = "white") 
```


::: {.solution exercise="ex_71"}

#### Solution


```{webr}
#| exercise: ex_71
#| solution: true
ggplot(sugarcane, aes(x = yield)) +
  geom_histogram(aes(y = after_stat(density)), bins = 30, color = "white") 
```

:::


```{webr}
#| exercise: ex_71
#| check: true
gradethis::grade_this_code()
```


Estimate the mean and standard deviation of the `yield` variable.


```{webr}
#| exercise: ex_72
#| caption: Exercise 7.2
sugarcane |> 
  summarise(mean = ______, sd = ______)
```


::: {.solution exercise="ex_72"}

#### Solution


```{webr}
#| exercise: ex_72
#| solution: true
sugarcane |> 
  summarise(mean = mean(yield), sd = sd(yield))
```

:::


```{webr}
#| exercise: ex_72
#| check: true
gradethis::grade_this_code()
```

Assuming that the `yield` is normally distributed with the mean and standard deviation estimated from the data, try plotting this estimated density onto the histogram with 30 bins. 


```{webr}
#| exercise: ex_73
#| caption: Exercise 7.3
ggplot(sugarcane, aes(x = yield)) +
  geom_histogram(aes(y = after_stat(density)), 
                 bins = ______, 
                 color = "white") +
  geom_function(fun = \(x) dnorm(x, 
                                 mean(______), 
                                 sd(sugarcane$yield)),
                color = "red", linewidth = 1.5)
```


::: {.solution exercise="ex_73"}

#### Solution


```{webr}
#| exercise: ex_73
#| solution: true
ggplot(sugarcane, aes(x = yield)) +
  geom_histogram(aes(y = after_stat(density)), 
                 bins = 30, 
                 color = "white") +
  geom_function(fun = \(x) dnorm(x, 
                                 mean(sugarcane$yield),
                                 sd(sugarcane$yield)),
                color = "red", linewidth = 1.5)
```

:::


```{webr}
#| exercise: ex_73
#| check: true
gradethis::grade_this_code()
```



